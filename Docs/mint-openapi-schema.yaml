openapi: 3.0.3
info:
  title: Mint Hardware Control API
  description: |
    米特(Mint)具身智能硬件控制 API。
    通过此 API 可以控制米特的音量、屏幕亮度、舵机动作、表情和 LED 灯效。

    **注意**:
    - 所有请求都需要提供 `device_id` 参数来指定要控制的设备
    - 所有请求都需要提供 API Key 进行鉴权

    **鉴权方式** (二选一):
    - `Authorization: Bearer <your-api-key>`
    - `X-API-Key: <your-api-key>`
  version: 1.0.0
  contact:
    name: Mint Support

servers:
  - url: http://120.26.38.27:8003
    description: 生产服务器

security:
  - BearerAuth: []
  - ApiKeyAuth: []

paths:
  /api/v1/devices:
    get:
      operationId: getDevices
      summary: 获取已连接设备列表
      description: 返回当前所有已连接的米特设备ID列表
      responses:
        '200':
          description: 成功获取设备列表
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  devices:
                    type: array
                    items:
                      type: string
                    example: ["device_001", "device_002"]
                  count:
                    type: integer
                    example: 2

  /api/v1/volume:
    post:
      operationId: controlVolume
      summary: 控制音量
      description: |
        控制米特的音量大小。支持以下操作：
        - set: 设置具体音量值 (0-100)
        - up: 调大音量
        - down: 调小音量
        - mute: 静音
        - unmute: 取消静音
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - device_id
                - action
              properties:
                device_id:
                  type: string
                  description: 设备ID
                  example: "device_001"
                action:
                  type: string
                  enum: [set, up, down, mute, unmute]
                  description: 音量操作类型
                  example: "set"
                value:
                  type: integer
                  minimum: 0
                  maximum: 100
                  description: 音量值，仅当 action 为 set 时需要
                  example: 50
      responses:
        '200':
          description: 操作成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommandResponse'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/brightness:
    post:
      operationId: controlBrightness
      summary: 控制屏幕亮度
      description: |
        控制米特屏幕（眼睛）的亮度。支持以下操作：
        - set: 设置具体亮度值 (0-100)
        - up: 调亮屏幕
        - down: 调暗屏幕
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - device_id
                - action
              properties:
                device_id:
                  type: string
                  description: 设备ID
                  example: "device_001"
                action:
                  type: string
                  enum: [set, up, down]
                  description: 亮度操作类型
                  example: "set"
                value:
                  type: integer
                  minimum: 0
                  maximum: 100
                  description: 亮度值，仅当 action 为 set 时需要
                  example: 80
      responses:
        '200':
          description: 操作成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommandResponse'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/screen/power:
    post:
      operationId: controlScreenPower
      summary: 控制屏幕开关
      description: 打开或关闭米特的屏幕（眼睛）
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - device_id
                - power
              properties:
                device_id:
                  type: string
                  description: 设备ID
                  example: "device_001"
                power:
                  type: string
                  enum: [on, off]
                  description: 开关状态
                  example: "on"
      responses:
        '200':
          description: 操作成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommandResponse'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/motion:
    post:
      operationId: controlMotion
      summary: 控制舵机动作
      description: |
        控制米特的头部舵机执行预设动作。支持以下动作：
        - neutral: 回正/中立位置
        - nod: 点头
        - shake: 摇头
        - tilt_left: 向左歪头
        - tilt_right: 向右歪头
        - look_up: 抬头
        - look_down: 低头
        - look_left: 向左看
        - look_right: 向右看
        - excited: 兴奋摇摆
        - shy: 害羞低头
        - greeting: 打招呼
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - device_id
                - motion
              properties:
                device_id:
                  type: string
                  description: 设备ID
                  example: "device_001"
                motion:
                  type: string
                  enum: [neutral, nod, shake, tilt_left, tilt_right, look_up, look_down, look_left, look_right, excited, shy, greeting]
                  description: 动作名称
                  example: "nod"
      responses:
        '200':
          description: 操作成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommandResponse'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/emotion:
    post:
      operationId: controlEmotion
      summary: 控制表情
      description: |
        控制米特的表情显示。支持以下表情：
        - neutral: 默认/平静
        - happy: 开心
        - sad: 悲伤
        - angry: 生气
        - surprised: 惊讶
        - sleepy: 困倦
        - thinking: 思考
        - love: 喜爱/爱心眼
        - doubt: 疑惑
        - scared: 害怕
        - proud: 骄傲
        - speechless: 无语
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - device_id
                - emotion
              properties:
                device_id:
                  type: string
                  description: 设备ID
                  example: "device_001"
                emotion:
                  type: string
                  enum: [neutral, happy, sad, angry, surprised, sleepy, thinking, love, doubt, scared, proud, speechless]
                  description: 表情名称
                  example: "happy"
      responses:
        '200':
          description: 操作成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommandResponse'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/led:
    post:
      operationId: controlLed
      summary: 控制 LED 灯效
      description: |
        控制米特的 LED 灯光效果。支持以下预设效果：
        - default: 默认白光
        - rainbow: 彩虹渐变
        - breathing: 呼吸灯
        - pulse: 脉冲闪烁
        - sparkle: 星光闪烁
        - wave: 波浪流动
        - fire: 火焰效果
        - ocean: 海洋蓝
        - forest: 森林绿
        - sunset: 日落橙
        - aurora: 极光效果
        - party: 派对模式
        - relax: 放松模式
        - focus: 专注模式
        - sleep: 睡眠模式
        - alert: 警告红
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - device_id
                - effect
              properties:
                device_id:
                  type: string
                  description: 设备ID
                  example: "device_001"
                effect:
                  type: string
                  enum: [default, rainbow, breathing, pulse, sparkle, wave, fire, ocean, forest, sunset, aurora, party, relax, focus, sleep, alert]
                  description: 灯效名称
                  example: "rainbow"
      responses:
        '200':
          description: 操作成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommandResponse'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/led/color:
    post:
      operationId: controlLedColor
      summary: 设置 LED 自定义颜色
      description: 设置米特 LED 的自定义 RGB 颜色和亮度
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - device_id
              properties:
                device_id:
                  type: string
                  description: 设备ID
                  example: "device_001"
                red:
                  type: integer
                  minimum: 0
                  maximum: 255
                  default: 255
                  description: 红色分量 (0-255)
                  example: 255
                green:
                  type: integer
                  minimum: 0
                  maximum: 255
                  default: 255
                  description: 绿色分量 (0-255)
                  example: 128
                blue:
                  type: integer
                  minimum: 0
                  maximum: 255
                  default: 255
                  description: 蓝色分量 (0-255)
                  example: 0
                brightness:
                  type: integer
                  minimum: 0
                  maximum: 100
                  default: 100
                  description: 亮度 (0-100)
                  example: 80
      responses:
        '200':
          description: 操作成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommandResponse'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      description: |
        使用 Bearer Token 鉴权。
        在请求头中添加: Authorization: Bearer <your-api-key>
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: |
        使用 API Key 鉴权。
        在请求头中添加: X-API-Key: <your-api-key>

  schemas:
    CommandResponse:
      type: object
      properties:
        success:
          type: boolean
          description: 操作是否成功
          example: true
        message:
          type: string
          description: 操作结果消息
          example: "音量已调整到 50"

    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
          description: 错误信息
          example: "缺少 device_id 参数"

    UnauthorizedResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
          example: "未授权访问，请提供有效的 API Key"
